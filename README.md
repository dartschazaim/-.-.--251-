## **Алгоритм работы программы «Фотоархив»**

**Начало алгоритма**

### **1. Инициализация программы:**
   - **Шаг 1.1:** Установить русскую локализацию (кодировка Windows-1251)
   - **Шаг 1.2:** Вывести заголовок программы "БАЗА ДАННЫХ 'ФОТОАРХИВ'"
   - **Шаг 1.3:** Попытаться открыть файл `photo_archive.txt`
   - **Шаг 1.4:** Если файл существует:
     - Загрузить данные из файла в массив структур `Photo`
     - Подсчитать количество загруженных записей
     - Вывести сообщение о количестве загруженных записей
   - **Шаг 1.5:** Если файл не существует:
     - Создать пустую базу данных
     - Вывести сообщение о создании новой базы

### **2. Главный цикл работы (пока не выбран выход):**
   - **Шаг 2.1:** Очистить экран
   - **Шаг 2.2:** Отобразить главное меню с 7 пунктами
   - **Шаг 2.3:** Получить выбор пользователя (цифра от 0 до 6)
   - **Шаг 2.4:** Выполнить выбранную операцию:

#### **Вариант 1: Просмотр всех записей**
   - **Шаг 2.4.1:** Проверить, есть ли записи в базе
   - **Шаг 2.4.2:** Если записи есть:
     - Вывести заголовок таблицы
     - Для каждой записи (от 0 до количества записей):
       - Вывести номер записи
       - Вывести название, дату, место, категорию
       - Вывести размер, разрешение, формат
     - Вывести итоговое количество записей
   - **Шаг 2.4.3:** Если записей нет:
     - Вывести сообщение "База данных пуста"

#### **Вариант 2: Добавление новой фотографии**
   - **Шаг 2.4.4:** Проверить, есть ли свободное место в массиве
   - **Шаг 2.4.5:** Если место есть:
     - Запросить у пользователя название фотографии (макс. 50 символов)
     - Запросить дату съемки в формате ГГГГ-ММ-ДД
       - Проверить корректность формата даты
       - Повторять запрос, пока не будет введена корректная дата
     - Запросить место съемки (макс. 50 символов)
     - Запросить категорию (макс. 30 символов)
     - Запросить теги через запятую (макс. 100 символов)
     - Запросить размер файла в МБ
       - Проверить, что введено положительное число
       - Разрешить ввод с точкой или запятой
     - Запросить ширину изображения в пикселях
       - Проверить, что введено целое положительное число
     - Запросить высоту изображения в пикселях
       - Проверить, что введено целое положительное число
     - Запросить формат файла (макс. 10 символов)
     - Добавить новую запись в массив
     - Увеличить счетчик записей на 1
     - Установить флаг "есть несохраненные изменения"
     - Вывести сообщение об успешном добавлении

#### **Вариант 3: Поиск по месту съемки**
   - **Шаг 2.4.6:** Запросить у пользователя место для поиска
   - **Шаг 2.4.7:** Для каждой записи в базе:
     - Проверить, содержится ли введенная подстрока в поле "Место съемки"
     - Если содержится:
       - Вывести информацию о найденной фотографии
       - Увеличить счетчик найденных записей
   - **Шаг 2.4.8:** Вывести количество найденных записей
   - **Шаг 2.4.9:** Если ничего не найдено - вывести соответствующее сообщение

#### **Вариант 4: Комбинированный поиск (дата + теги)**
   - **Шаг 2.4.10:** Запросить дату для поиска в формате ГГГГ-ММ-ДД
     - Проверить корректность формата даты
     - Если формат неверен - вернуться в меню
   - **Шаг 2.4.11:** Запросить тег для поиска
   - **Шаг 2.4.12:** Для каждой записи в базе:
     - Проверить точное совпадение даты
     - Проверить наличие тега в строке тегов
     - Если оба условия выполняются:
       - Вывести подробную информацию о фотографии
       - Увеличить счетчик найденных записей
   - **Шаг 2.4.13:** Вывести количество найденных записей

#### **Вариант 5: Многоуровневая сортировка**
   - **Шаг 2.4.14:** Проверить, что в базе более 1 записи
   - **Шаг 2.4.15:** Выполнить сортировку массива по трем уровням:
     - **Уровень 1:** Дата съемки (по возрастанию)
     - **Уровень 2:** Категория (алфавитный порядок)
     - **Уровень 3:** Разрешение (ширина × высота, по возрастанию)
   - **Шаг 2.4.16:** Установить флаг "есть несохраненные изменения"
   - **Шаг 2.4.17:** Вывести сообщение об успешной сортировке

#### **Вариант 6: Сохранение в файл**
   - **Шаг 2.4.18:** Открыть файл `photo_archive.txt` для записи
   - **Шаг 2.4.19:** Для каждой записи в базе:
     - Записать все поля в файл через разделитель "|"
     - Каждая запись в отдельной строке
   - **Шаг 2.4.20:** Закрыть файл
   - **Шаг 2.4.21:** Сбросить флаг "есть несохраненные изменения"
   - **Шаг 2.4.22:** Вывести сообщение об успешном сохранении

#### **Вариант 0: Выход из программы**
   - **Шаг 2.4.23:** Проверить флаг "есть несохраненные изменения"
   - **Шаг 2.4.24:** Если есть несохраненные изменения:
     - Спросить пользователя: "Сохранить изменения перед выходом? (y/n)"
     - Если ответ "y" или "Y":
       - Выполнить сохранение в файл
     - Если ответ "n" или "N":
       - Выйти без сохранения
   - **Шаг 2.4.25:** Вывести прощальное сообщение
   - **Шаг 2.4.26:** Завершить выполнение программы

### **3. После выполнения любой операции (кроме выхода):**
   - **Шаг 3.1:** Вывести сообщение "Для продолжения нажмите Enter..."
   - **Шаг 3.2:** Ожидать нажатия клавиши Enter
   - **Шаг 3.3:** Вернуться к Шагу 2.1 (отображению главного меню)

### **4. Обработка ошибок:**
   - **Шаг 4.1:** При неверном выборе в меню - вывести сообщение об ошибке
   - **Шаг 4.2:** При ошибке ввода данных - запросить повторный ввод
   - **Шаг 4.3:** При ошибке работы с файлом - вывести информативное сообщение
   - **Шаг 4.4:** Всегда возвращаться в главное меню после ошибки

**Конец алгоритма**
